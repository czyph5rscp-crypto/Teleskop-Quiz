<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Teleskop-Führerschein — Quiz</title>
<style>
   :root{--bg:#0f1724;--card:#0b1220;--accent:#ff8c00;--muted:#9aa7b2;--white:#edf2f7}
   *{box-sizing:border-box}
   body{font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial; margin:0; background:linear-gradient(180deg,#071026 0%, #0b1630 100%); color:var(--white); min-height:100vh; display:flex; align-items:center; justify-content:center; padding:24px}
   .container{width:100%;max-width:1000px}
   .card{background:rgba(255,255,255,0.03); padding:28px;border-radius:12px; box-shadow: 0 6px 30px rgba(2,6,23,0.6)}
   header{display:flex; align-items:center; justify-content:space-between; gap:16px; margin-bottom:18px}
   header h1{font-size:20px; margin:0}
   header p{margin:0; color:var(--muted)}
   .center{display:flex; align-items:center; justify-content:center; flex-direction:column; gap:12px; padding:28px 12px}
   button.primary{background:var(--accent); border:0; color:#051226; padding:12px 18px; border-radius:8px; cursor:pointer; font-weight:600}
   button.ghost{background:transparent; border:1px solid rgba(255,255,255,0.06); color:var(--white); padding:10px 14px; border-radius:8px; cursor:pointer}
   .quiz{display:none; margin-top:12px}
   .question{background:rgba(255,255,255,0.02); padding:14px; border-radius:10px; margin-bottom:12px}
   .qtitle{font-weight:600; margin-bottom:8px}
   .options{display:flex; flex-direction:column; gap:8px}
   label.option{display:flex; gap:10px; align-items:flex-start; cursor:pointer; padding:8px; border-radius:8px}
   label.option:hover{background:rgba(255,255,255,0.02)}
   input[type="radio"], input[type="checkbox"]{transform:translateY(2px)}
   .actions{display:flex; gap:12px; margin-top:16px; align-items:center}
   .result{display:none; margin-top:16px; padding:16px; border-radius:10px; background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01))}
   .pass{color:#0b6f2a; font-weight:700}
   .fail{color:#c53030; font-weight:700}
   .cert{display:none; margin-top:18px; padding:18px; border-radius:10px; background:#fff; color:#000}
   .cert .title{font-size:22px; font-weight:700; text-align:center; margin-bottom:8px}
   .cert .bigname{font-size:26px; font-weight:800; text-align:center; margin:10px 0}
   .cert .meta{font-size:14px; color:#222; text-align:center; margin-bottom:18px}
   .print-btn{background:#0b1220; color:#fff; border:0; padding:10px 12px; border-radius:8px; cursor:pointer}
   .download-btn{background:#047857; color:#fff; border:0; padding:10px 12px; border-radius:8px; cursor:pointer}
   .required{color:#ffb4a2; font-size:13px}
   footer{margin-top:16px; color:var(--muted); font-size:13px; text-align:center}
   @media print{
     body{background:#fff; color:#000}
     .card, header, .actions, .quiz .question input, .quiz .question label { box-shadow:none }
     .cert{display:block; page-break-inside:avoid}
     .no-print{display:none}
   }
</style>
</head>
<body>
<div class="container">
<div class="card">
<header>
<div>
<h1>Teleskop-Führerschein — Quiz</h1>
<p>Beantworte die Fragen, erreiche mindestens 75% und erhalte dein Zertifikat.</p>
</div>
<div style="text-align:right">
<small class="required">Hinweis: Fragen mit mehreren korrekten Antworten erfordern Mehrfachauswahl.</small>
</div>
</header>
<div class="center" id="start-screen">
<p>Bereit für das Quiz? Klicke auf "Quiz starten" und gib deinen Namen ein.</p>
<button class="primary" id="startBtn">Quiz starten</button>
</div>
<div id="name-modal" style="display:none; margin-top:12px;">
<label for="username">Dein Name (für das Zertifikat):</label>
<input id="username" type="text" placeholder="Vorname Nachname" style="width:100%; padding:10px; margin-top:8px; border-radius:8px; border:1px solid rgba(255,255,255,0.06); background:transparent; color:var(--white)"/>
<div style="display:flex; gap:10px; margin-top:10px;">
<button class="primary" id="nameConfirm">Weiter</button>
<button class="ghost" id="nameCancel">Abbrechen</button>
</div>
</div>
<form id="quiz-form" class="quiz" novalidate>
<!-- Fragen werden per JS eingefügt -->
</form>
<div class="actions no-print" id="after-quiz-actions" style="display:none">
<button class="primary" id="submitQuiz">Quiz auswerten</button>
<button class="ghost" id="resetQuiz">Erneut anfangen</button>
</div>
<div class="result" id="resultBox"></div>
<div class="cert" id="certificate" role="region" aria-label="Zertifikat">
<div class="title">Teleskop-Führerschein</div>
<div class="meta">Dieses Zertifikat bestätigt, dass</div>
<div class="bigname" id="certName">NAME</div>
<div class="meta" id="certMeta">erfolgreich den Teleskop-Führerschein bestanden hat.</div>
<div style="display:flex; justify-content:space-between; margin-top:30px; align-items:center;">
<div>
<div style="font-weight:700">Datum</div>
<div id="certDate"></div>
</div>
<div style="text-align:center">
<div style="font-weight:700">Ergebnis</div>
<div id="certScore"></div>
</div>
<div style="width:180px; text-align:center">
<div style="font-weight:700">Unterschrift</div>
<div style="margin-top:26px">______________________</div>
</div>
</div>
<div style="margin-top:18px; display:flex; gap:10px;">
<button class="download-btn no-print" id="downloadPdf">Als PDF herunterladen</button>
<button class="print-btn no-print" id="printCert">Zertifikat drucken</button>
<button class="ghost no-print" id="closeCert">Schließen</button>
</div>
</div>
<footer>
       Viel Erfolg beim Lernen — und immer sicher beobachten!
</footer>
</div>
</div>
<!-- Bibliotheken für PDF-Generierung -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" integrity="sha512-BNa5m6cIW+9HkzZ2b6J4G8yR3kV4q9u0+FZ0WBXn4m3FCvZl/0mYjvYp9eN8m3X2POp3Q0n2Zr4+8b1Z6v7YBQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" integrity="sha512-+gT9zZq+GTT7mGk2d6h2gQ9KjEoG9G+dg2JcG7+F7yI2H1vWkq6kVq0mRZ4lO8u1p0x5o3gYQ0vQK0E1a2B9g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
   // Quiz-Daten
   const questions = [
     { q: "1. Wofür wird ein Teleskop hauptsächlich verwendet?", options:["Zum Beobachten von Himmelsobjekten","Zum Messen von Temperaturen","Zum Fotografieren von Tieren","Zum Erstellen von 3D‑Modellen"], correct:[0], multi:false },
     { q: "2. Welche Komponente sammelt das Licht im Teleskop?", options:["Okular","Hauptspiegel oder Objektiv","Stativ","Sucherfernrohr"], correct:[1], multi:false },
     { q: "3. Wofür dient das Okular?", options:["Zum Vergrößern des Bildes","Zum Ausrichten des Teleskops","Zum Stabilisieren des Stativs","Zum Messen der Entfernung"], correct:[0], multi:false },
     { q: "4. Warum sollte ein Teleskop vor der Beobachtung abkühlen?", options:["Damit die Optik stabil wird","Damit es leichter wird","Damit es heller leuchtet","Damit das Stativ nicht wackelt"], correct:[0], multi:false },
     { q: "5. Was bedeutet die Öffnung eines Teleskops?", options:["Die Länge des Stativs","Der Durchmesser des Hauptspiegels/Objektivs","Die Größe des Okulars","Die Anzahl der Schrauben"], correct:[1], multi:false },
     { q: "6. Was beschreibt die Brennweite eines Teleskops?", options:["Wie weit das Teleskop werfen kann","Wie stark das Bild vergrößert wird","Den Abstand zwischen Spiegel und Okular","Die Farbe des Teleskops"], correct:[1], multi:false },
     { q: "7. Wofür nutzt man ein Sucherfernrohr?", options:["Zum leichteren Finden von Objekten","Zum Vergrößern","Zum Scharfstellen","Zum Stabilisieren"], correct:[0], multi:false },
     { q: "8. Was passiert, wenn man zu stark vergrößert?", options:["Das Bild wird dunkler und unscharf","Das Bild wird heller","Das Teleskop wird schwerer","Die Farben werden kräftiger"], correct:[0], multi:false },
     { q: "9. Welche Himmelsobjekte sind besonders hell und leicht zu finden?", options:["Mond und Jupiter","Neptun und ferne Galaxien","Schwarze Löcher","Asteroiden im Kuipergürtel"], correct:[0], multi:false },
     { q: "10. Was ist da Celestron-8 Teleskop (orange) für ein Typ?", options:["Spiegelteleskop (Reflektor)","Linsenteleskop (Refraktor)","Katadioptrisches Teleskop"], correct:[2], multi:false },
     { q: "11. Was sind gute Bedingungen für die Himmelsbeobachtung?", options:["Dunkler Himmel ohne Lichtverschmutzung","Klarer, trockener Himmel ohne Wolken","Ruhige Atmosphäre (gutes Seeing)","Heller Vollmond direkt über dir"], correct:[0,1,2], multi:true },
     { q: "12. Was bedeutet „Justieren“ (Kollimation)?", options:["Das Teleskop anmalen","Die Spiegel richtig ausrichten","Das Stativ verlängern","Das Okular reinigen"], correct:[1], multi:false },
     { q: "13. Warum ist ein stabiles Stativ wichtig?", options:["Damit das Bild nicht wackelt","Damit das Teleskop leichter wird","Damit es bunter aussieht","Damit es schneller wird"], correct:[0], multi:false },
     { q: "14. Wie finde ich heraus, was ich beobachten kann?", options:["Mit einem gewöhnlichen Magnet-Kompass","Mithilfe einer Sternkarten-App","Tonights-Best Website","Via Horoskopdeutung in Astrologie-Büchern"], correct:[1], multi:false },
     { q: "15. Warum darf man niemals ohne Sonnenfilter durch das Teleskop in die Sonne schauen?", options:["Eigentlich nicht gefährlich","Man könnte erblinden","Die Lichtstrahlen werden gebündelt und schaden so dem Auge"], correct:[1], multi:false },
     { q: "16. Wie berechnet man die Brennzahl?", options:["Brennweite des Teleskops × Durchmesser der Öffnung des Teleskops","Brennweite des Teleskops + Durchmesser der Öffnung des Teleskops","Brennweite des Teleskops ÷ Brennweite des Okulars","Brennweite des Teleskops ÷ Durchmesser des Okulars"], correct:[2], multi:false },
     { q: "17. Warum darf man niemals ohne Sonnenfilter durch das Teleskop in die Sonne schauen?", options:["Nie längere Zeit mit einem Auge durch das Teleskop sehen, da die Augenmuskulatur überbeansprucht wird","niemals ohne Sonnenfilter die Sonne oder andere helle Objekte beobachten","Stets sicherstellen, dass alle Komponenten korrekt montiert sind, da sonst die Gefahr besteht, dass das Teleskop umkippt oder man sich die Finger einklemmt"], correct:[1,2], multi:true }
   ];
   const quizForm = document.getElementById('quiz-form');
   const startBtn = document.getElementById('startBtn');
   const nameModal = document.getElementById('name-modal');
   const nameConfirm = document.getElementById('nameConfirm');
   const nameCancel = document.getElementById('nameCancel');
   const usernameInput = document.getElementById('username');
   const afterActions = document.getElementById('after-quiz-actions');
   const submitQuiz = document.getElementById('submitQuiz');
   const resetQuiz = document.getElementById('resetQuiz');
   const resultBox = document.getElementById('resultBox');
   const certificate = document.getElementById('certificate');
   const certName = document.getElementById('certName');
   const certMeta = document.getElementById('certMeta');
   const certDate = document.getElementById('certDate');
   const certScore = document.getElementById('certScore');
   const printCert = document.getElementById('printCert');
   const downloadPdf = document.getElementById('downloadPdf');
   const closeCert = document.getElementById('closeCert');
   let currentName = '';
   // Erzeuge das Formular mit Fragen
   function renderQuestions() {
     quizForm.innerHTML = '';
     questions.forEach((item, qi) => {
       const qdiv = document.createElement('div');
       qdiv.className = 'question';
       const title = document.createElement('div');
       title.className = 'qtitle';
       title.textContent = item.q;
       qdiv.appendChild(title);
       const opts = document.createElement('div');
       opts.className = 'options';
       item.options.forEach((opt, oi) => {
         const id = `q${qi}_opt${oi}`;
         const label = document.createElement('label');
         label.className = 'option';
         label.setAttribute('for', id);
         const input = document.createElement('input');
         input.type = item.multi ? 'checkbox' : 'radio';
         input.name = `q${qi}`;
input.id = id;
         input.value = oi;
         input.dataset.q = qi;
         input.dataset.opt = oi;
         label.appendChild(input);
         const span = document.createElement('span');
         span.textContent = opt;
         label.appendChild(span);
         opts.appendChild(label);
       });
       qdiv.appendChild(opts);
       quizForm.appendChild(qdiv);
     });
   }
   // Start-Button -> Name-Eingabe anzeigen
   startBtn.addEventListener('click', () => {
     document.getElementById('start-screen').style.display = 'none';
     nameModal.style.display = 'block';
     usernameInput.focus();
   });
   nameCancel.addEventListener('click', () => {
     nameModal.style.display = 'none';
     document.getElementById('start-screen').style.display = 'flex';
   });
   nameConfirm.addEventListener('click', () => {
     const name = usernameInput.value.trim();
     if (!name) {
       alert('Bitte gib deinen Namen ein.');
       usernameInput.focus();
       return;
     }
     currentName = name;
     nameModal.style.display = 'none';
     renderQuestions();
     quizForm.style.display = 'block';
     afterActions.style.display = 'flex';
     window.scrollTo({top:0,behavior:'smooth'});
   });
   // Reset quiz
   resetQuiz.addEventListener('click', () => {
     if (!confirm('Quiz wirklich zurücksetzen? Dein Name bleibt erhalten.')) return;
     renderQuestions();
     resultBox.style.display = 'none';
     certificate.style.display = 'none';
     document.getElementById('quiz-form').style.display = 'block';
   });
   // Auswertung
   submitQuiz.addEventListener('click', () => {
     const answers = [];
     let allAnswered = true;
     for (let i=0;i<questions.length;i++){
       const q = questions[i];
       if (q.multi) {
         const selected = Array.from(quizForm.querySelectorAll(`input[name="q${i}"]:checked`)).map(n=>Number(n.value));
         if (selected.length === 0) allAnswered = false;
         answers.push(selected);
       } else {
         const sel = quizForm.querySelector(`input[name="q${i}"]:checked`);
         if (!sel) { allAnswered = false; answers.push(null); }
         else answers.push([Number(sel.value)]);
       }
     }
     if (!allAnswered) {
       if (!confirm('Einige Fragen sind noch unbeantwortet. Möchtest du trotzdem auswerten?')) return;
     }
     let correctCount = 0;
     for (let i=0;i<questions.length;i++){
       const provided = answers[i];
       const correct = questions[i].correct.slice().sort((a,b)=>a-b);
       if (!provided) continue;
       const provSorted = provided.slice().sort((a,b)=>a-b);
       if (arraysEqual(correct, provSorted)) correctCount++;
     }
     const total = questions.length;
     const pct = Math.round((correctCount/total)*100);
     const passed = pct >= 75;
     resultBox.style.display = 'block';
     resultBox.innerHTML = `
<div style="font-size:18px; font-weight:700">${passed ? '<span class="pass">BESTANDEN</span>' : '<span class="fail">NICHT BESTANDEN</span>'}</div>
<div style="margin-top:6px">Punkte: ${correctCount} / ${total} — ${pct}%</div>
<div style="margin-top:8px; color:var(--muted)">Du hast ${passed ? 'die erforderlichen 75% erreicht.' : 'nicht genügend Punkte erreicht. Versuche es noch einmal.'}</div>
     `;
     if (passed) {
       certName.textContent = currentName;
       certDate.textContent = new Date().toLocaleDateString('de-DE');
       certScore.textContent = `${pct}% (${correctCount}/${total})`;
       certificate.style.display = 'block';
       certificate.scrollIntoView({behavior:'smooth'});
     } else {
       certificate.style.display = 'none';
     }
   });
   // Drucken (Browser-Dialog)
   printCert.addEventListener('click', () => {
     if (certificate.style.display === 'none') {
       alert('Kein Zertifikat zum Drucken vorhanden.');
       return;
     }
     window.print();
   });
   // PDF-Download: html2canvas -> jsPDF
   downloadPdf.addEventListener('click', async () => {
     if (certificate.style.display === 'none') {
       alert('Kein Zertifikat zum Herunterladen vorhanden.');
       return;
     }
     // Stelle sicher, dass die Zertifikat-Box weißer Hintergrund hat beim Rendern
     certificate.style.background = '#ffffff';
     // small pause, scroll to top of cert for stable render
     certificate.scrollIntoView({behavior:'instant', block:'center'});
     try {
       const opts = { scale: 2, useCORS: true, backgroundColor: '#ffffff' };
       const canvas = await html2canvas(certificate, opts);
       const imgData = canvas.toDataURL('image/png');
       // jsPDF (UMD) verfügbar unter window.jspdf
       const pdf = new window.jspdf.jsPDF('p', 'mm', 'a4');
       const pdfWidth = 210;
       const pdfHeight = 297;
       // Bildgröße in mm (breite auf A4-Breite skalieren)
       const imgWidth = pdfWidth;
       const imgHeight = (canvas.height * imgWidth) / canvas.width;
       if (imgHeight <= pdfHeight) {
         pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);
       } else {
         // Wenn das Bild höher als eine Seite ist, skaliere so, dass es in die Seite passt
         const scale = pdfHeight / imgHeight;
         const fittedWidth = imgWidth * scale;
         const fittedHeight = imgHeight * scale;
         const left = (pdfWidth - fittedWidth) / 2;
         pdf.addImage(imgData, 'PNG', left, 0, fittedWidth, fittedHeight);
       }
       const safeName = (currentName || 'Zertifikat').replace(/[\\\/:*?"<>|]+/g, '_').replace(/\s+/g, '_');
       pdf.save(`Teleskop-Fuehrerschein-${safeName}.pdf`);
     } catch (err) {
       console.error(err);
       alert('Fehler beim Erstellen des PDFs. Öffne die Entwicklerkonsole für Details.');
     } finally {
       // Falls du möchtest, kann hier die ursprüngliche Hintergrundfarbe wiederhergestellt werden
       certificate.style.background = '#fff';
     }
   });
   closeCert.addEventListener('click', () => {
     certificate.style.display = 'none';
   });
   function arraysEqual(a,b){
     if (!a || !b) return false;
     if (a.length !== b.length) return false;
     for (let i=0;i<a.length;i++) if (a[i] !== b[i]) return false;
     return true;
   }
   renderQuestions();
</script>
</body>
</html>